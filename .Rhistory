resultsYear <- read.dbf(paste("./data/dbf/", year, ".dbf", sep=""))
resultsYear <- resultsYear$dbf
resultsYear <- resultsYear %>%
distinct(FIPS) %>%
na.omit() %>%
filter(VOTE_DEM != -9999)
resultsYear[] <- lapply(resultsYear, function(x) type.convert(as.character(x)))
countiesYear <- resultsYear %>%
group_by(state=STATE, county=COUNTY) %>%
summarize(dem=VOTE_DEM,rep=VOTE_REP,other=VOTE_OTH) %>%
gather(party, votes, dem:other)
statesYear <- countiesYear %>%
group_by(state, party) %>%
summarize(votes=sum(votes))
totalYear <- statesYear %>%
group_by(party) %>%
summarize(votes=sum(votes))
write.csv(countiesYear, paste("./data/csv/counties", year, ".csv", sep = ""), row.names = FALSE)
write.csv(statesYear, paste("./data/csv/states", year, ".csv", sep = ""), row.names=FALSE)
write.csv(totalYear, paste("./data/csv/total", year, ".csv", sep = ""), row.names = FALSE)
}
getResults(2008)
getResults(2004)
getResults(2008)
getResults(2012)
View(results2012)
getResults <- function(year, dem_col, rep_col, oth_col) {
resultsYear <- read.dbf(paste("./data/dbf/", year, ".dbf", sep=""))
resultsYear <- resultsYear$dbf
resultsYear <- resultsYear %>%
distinct(FIPS) %>%
na.omit() %>%
filter(dem_col != -9999)
resultsYear[] <- lapply(resultsYear, function(x) type.convert(as.character(x)))
countiesYear <- resultsYear %>%
group_by(state=STATE, county=COUNTY) %>%
summarize(dem=dem_col,rep=rep_col,other=oth_col) %>%
gather(party, votes, dem:other)
statesYear <- countiesYear %>%
group_by(state, party) %>%
summarize(votes=sum(votes))
totalYear <- statesYear %>%
group_by(party) %>%
summarize(votes=sum(votes))
write.csv(countiesYear, paste("./data/csv/counties", year, ".csv", sep = ""), row.names = FALSE)
write.csv(statesYear, paste("./data/csv/states", year, ".csv", sep = ""), row.names=FALSE)
write.csv(totalYear, paste("./data/csv/total", year, ".csv", sep = ""), row.names = FALSE)
}
getResults(2004, VOTE_DEM, VOTE_REP, VOTE_OTH)
getResults(2008, VOTE_DEM, VOTE_REP, VOTE_OTH)
getResults(2012, OBAMA, ROMNEY, OTHERS)
getResults(2004, VOTE_DEM, VOTE_REP, VOTE_OTH)
getResults(2004, dem_col = VOTE_DEM, rep_col = VOTE_REP, oth_col = VOTE_OTH)
getResults(2004, dem_col = "VOTE_DEM", rep_col = "VOTE_REP", oth_col = "VOTE_OTH")
getResults <- function(year, dem_col, rep_col, oth_col) {
resultsYear <- read.dbf(paste("./data/dbf/", year, ".dbf", sep=""))
resultsYear <- resultsYear$dbf
resultsYear <- resultsYear %>%
distinct(FIPS) %>%
na.omit() %>%
filter_(~dem_col != -9999)
resultsYear[] <- lapply(resultsYear, function(x) type.convert(as.character(x)))
countiesYear <- resultsYear %>%
group_by(state=STATE, county=COUNTY) %>%
summarize_(dem=~dem_col,rep=~rep_col,other=~oth_col) %>%
gather(party, votes, dem:other)
statesYear <- countiesYear %>%
group_by(state, party) %>%
summarize(votes=sum(votes))
totalYear <- statesYear %>%
group_by(party) %>%
summarize(votes=sum(votes))
write.csv(countiesYear, paste("./data/csv/counties", year, ".csv", sep = ""), row.names = FALSE)
write.csv(statesYear, paste("./data/csv/states", year, ".csv", sep = ""), row.names=FALSE)
write.csv(totalYear, paste("./data/csv/total", year, ".csv", sep = ""), row.names = FALSE)
}
getResults(2004, dem_col = VOTE_DEM, rep_col = VOTE_REP, oth_col = VOTE_OTH)
getResults <- function(year, dem_col, rep_col, oth_col) {
resultsYear <- read.dbf(paste("./data/dbf/", year, ".dbf", sep=""))
resultsYear <- resultsYear$dbf
resultsYear <- resultsYear %>%
distinct(FIPS) %>%
na.omit() %>%
filter_(dem_col != -9999)
resultsYear[] <- lapply(resultsYear, function(x) type.convert(as.character(x)))
countiesYear <- resultsYear %>%
group_by(state=STATE, county=COUNTY) %>%
summarize_(dem=dem_col,rep=rep_col,other=oth_col) %>%
gather(party, votes, dem:other)
statesYear <- countiesYear %>%
group_by(state, party) %>%
summarize(votes=sum(votes))
totalYear <- statesYear %>%
group_by(party) %>%
summarize(votes=sum(votes))
write.csv(countiesYear, paste("./data/csv/counties", year, ".csv", sep = ""), row.names = FALSE)
write.csv(statesYear, paste("./data/csv/states", year, ".csv", sep = ""), row.names=FALSE)
write.csv(totalYear, paste("./data/csv/total", year, ".csv", sep = ""), row.names = FALSE)
}
getResults(2004, dem_col = VOTE_DEM, rep_col = VOTE_REP, oth_col = VOTE_OTH)
library(shapefiles)
library(dplyr)
library(tidyr)
library(lazyeval)
getResults <- function(year, dem_col, rep_col, oth_col) {
resultsYear <- read.dbf(paste("./data/dbf/", year, ".dbf", sep=""))
resultsYear <- resultsYear$dbf
resultsYear <- resultsYear %>%
distinct(FIPS) %>%
na.omit() %>%
filter_(dem_col != -9999)
resultsYear[] <- lapply(resultsYear, function(x) type.convert(as.character(x)))
countiesYear <- resultsYear %>%
group_by(state=STATE, county=COUNTY) %>%
summarize_(dem=quote(dem_col),rep=quote(rep_col),other=quote(oth_col)) %>%
gather(party, votes, dem:other)
statesYear <- countiesYear %>%
group_by(state, party) %>%
summarize(votes=sum(votes))
totalYear <- statesYear %>%
group_by(party) %>%
summarize(votes=sum(votes))
write.csv(countiesYear, paste("./data/csv/counties", year, ".csv", sep = ""), row.names = FALSE)
write.csv(statesYear, paste("./data/csv/states", year, ".csv", sep = ""), row.names=FALSE)
write.csv(totalYear, paste("./data/csv/total", year, ".csv", sep = ""), row.names = FALSE)
}
getResults(2004, dem_col = VOTE_DEM, rep_col = VOTE_REP, oth_col = VOTE_OTH)
getResults <- function(year, dem_col, rep_col, oth_col) {
resultsYear <- read.dbf(paste("./data/dbf/", year, ".dbf", sep=""))
resultsYear <- resultsYear$dbf
resultsYear <- resultsYear %>%
distinct(FIPS) %>%
na.omit() %>%
filter_(dem_col != -9999)
resultsYear[] <- lapply(resultsYear, function(x) type.convert(as.character(x)))
countiesYear <- resultsYear %>%
group_by(state=STATE, county=COUNTY) %>%
summarize_(dem= ~dem_col,rep= ~rep_col,other= ~oth_col) %>%
gather(party, votes, dem:other)
statesYear <- countiesYear %>%
group_by(state, party) %>%
summarize(votes=sum(votes))
totalYear <- statesYear %>%
group_by(party) %>%
summarize(votes=sum(votes))
write.csv(countiesYear, paste("./data/csv/counties", year, ".csv", sep = ""), row.names = FALSE)
write.csv(statesYear, paste("./data/csv/states", year, ".csv", sep = ""), row.names=FALSE)
write.csv(totalYear, paste("./data/csv/total", year, ".csv", sep = ""), row.names = FALSE)
}
getResults(2004, "VOTE_DEM", "VOTE_REP", "VOTE_OTH")
getResults(2008, VOTE_DEM, VOTE_REP, VOTE_OTH)
getResults <- function(year, dem_col, rep_col, oth_col) {
resultsYear <- read.dbf(paste("./data/dbf/", year, ".dbf", sep=""))
resultsYear <- resultsYear$dbf
resultsYear <- resultsYear %>%
distinct(FIPS) %>%
na.omit() %>%
filter_(dem_col != -9999)
resultsYear[] <- lapply(resultsYear, function(x) type.convert(as.character(x)))
countiesYear <- resultsYear %>%
group_by(state=STATE, county=COUNTY) %>%
summarize_(dem=interp(.values = dem_col),rep=interp(.values=rep_col),other=interp(.values=oth_col)) %>%
gather(party, votes, dem:other)
statesYear <- countiesYear %>%
group_by(state, party) %>%
summarize(votes=sum(votes))
totalYear <- statesYear %>%
group_by(party) %>%
summarize(votes=sum(votes))
write.csv(countiesYear, paste("./data/csv/counties", year, ".csv", sep = ""), row.names = FALSE)
write.csv(statesYear, paste("./data/csv/states", year, ".csv", sep = ""), row.names=FALSE)
write.csv(totalYear, paste("./data/csv/total", year, ".csv", sep = ""), row.names = FALSE)
}
getResults(2004, VOTE_DEM, VOTE_REP, VOTE_OTH)
getResults <- function(year, dem_col, rep_col, oth_col) {
resultsYear <- read.dbf(paste("./data/dbf/", year, ".dbf", sep=""))
resultsYear <- resultsYear$dbf
resultsYear <- resultsYear %>%
distinct(FIPS) %>%
na.omit() %>%
filter_(dem_col != -9999)
resultsYear[] <- lapply(resultsYear, function(x) type.convert(as.character(x)))
countiesYear <- resultsYear %>%
group_by(state=STATE, county=COUNTY) %>%
summarize_(dem=interp(~dem_col),rep=interp(~rep_col),other=interp(~oth_col)) %>%
gather(party, votes, dem:other)
statesYear <- countiesYear %>%
group_by(state, party) %>%
summarize(votes=sum(votes))
totalYear <- statesYear %>%
group_by(party) %>%
summarize(votes=sum(votes))
write.csv(countiesYear, paste("./data/csv/counties", year, ".csv", sep = ""), row.names = FALSE)
write.csv(statesYear, paste("./data/csv/states", year, ".csv", sep = ""), row.names=FALSE)
write.csv(totalYear, paste("./data/csv/total", year, ".csv", sep = ""), row.names = FALSE)
}
getResults(2004, VOTE_DEM, VOTE_REP, VOTE_OTH)
getResults <- function(year, dem_col, rep_col, oth_col) {
resultsYear <- read.dbf(paste("./data/dbf/", year, ".dbf", sep=""))
resultsYear <- resultsYear$dbf
resultsYear <- resultsYear %>%
distinct(FIPS) %>%
na.omit() %>%
filter_(~dem_col != -9999)
resultsYear[] <- lapply(resultsYear, function(x) type.convert(as.character(x)))
countiesYear <- resultsYear %>%
group_by(state=STATE, county=COUNTY) %>%
summarize_(dem=interp(~dem_col),rep=interp(~rep_col),other=interp(~oth_col)) %>%
gather(party, votes, dem:other)
statesYear <- countiesYear %>%
group_by(state, party) %>%
summarize(votes=sum(votes))
totalYear <- statesYear %>%
group_by(party) %>%
summarize(votes=sum(votes))
write.csv(countiesYear, paste("./data/csv/counties", year, ".csv", sep = ""), row.names = FALSE)
write.csv(statesYear, paste("./data/csv/states", year, ".csv", sep = ""), row.names=FALSE)
write.csv(totalYear, paste("./data/csv/total", year, ".csv", sep = ""), row.names = FALSE)
}
getResults(2004, VOTE_DEM, VOTE_REP, VOTE_OTH)
getResults <- function(year, dem_col, rep_col, oth_col) {
resultsYear <- read.dbf(paste("./data/dbf/", year, ".dbf", sep=""))
resultsYear <- resultsYear$dbf
resultsYear <- resultsYear %>%
distinct(FIPS) %>%
na.omit() %>%
filter_(interp(~dem_col) != -9999)
resultsYear[] <- lapply(resultsYear, function(x) type.convert(as.character(x)))
countiesYear <- resultsYear %>%
group_by(state=STATE, county=COUNTY) %>%
summarize_(dem=interp(~dem_col),rep=interp(~rep_col),other=interp(~oth_col)) %>%
gather(party, votes, dem:other)
statesYear <- countiesYear %>%
group_by(state, party) %>%
summarize(votes=sum(votes))
totalYear <- statesYear %>%
group_by(party) %>%
summarize(votes=sum(votes))
write.csv(countiesYear, paste("./data/csv/counties", year, ".csv", sep = ""), row.names = FALSE)
write.csv(statesYear, paste("./data/csv/states", year, ".csv", sep = ""), row.names=FALSE)
write.csv(totalYear, paste("./data/csv/total", year, ".csv", sep = ""), row.names = FALSE)
}
getResults(2004, VOTE_DEM, VOTE_REP, VOTE_OTH)
getResults <- function(year, dem_col, rep_col, oth_col) {
resultsYear <- read.dbf(paste("./data/dbf/", year, ".dbf", sep=""))
resultsYear <- resultsYear$dbf
resultsYear <- resultsYear %>%
distinct(FIPS) %>%
na.omit() %>%
filter_(interp(~dem_col) != -9999)
resultsYear[] <- lapply(resultsYear, function(x) type.convert(as.character(x)))
countiesYear <- resultsYear %>%
group_by(state=STATE, county=COUNTY) %>%
summarize_(.dots= list(dem=interp(~dem_col),rep=interp(~rep_col),other=interp(~oth_col))) %>%
gather(party, votes, dem:other)
statesYear <- countiesYear %>%
group_by(state, party) %>%
summarize(votes=sum(votes))
totalYear <- statesYear %>%
group_by(party) %>%
summarize(votes=sum(votes))
write.csv(countiesYear, paste("./data/csv/counties", year, ".csv", sep = ""), row.names = FALSE)
write.csv(statesYear, paste("./data/csv/states", year, ".csv", sep = ""), row.names=FALSE)
write.csv(totalYear, paste("./data/csv/total", year, ".csv", sep = ""), row.names = FALSE)
}
getResults(2004, VOTE_DEM, VOTE_REP, VOTE_OTH)
getResults <- function(year, dem_col, rep_col, oth_col) {
resultsYear <- read.dbf(paste("./data/dbf/", year, ".dbf", sep=""))
resultsYear <- resultsYear$dbf
resultsYear <- resultsYear %>%
distinct(FIPS) %>%
na.omit() %>%
filter_(interp(~dem_col) != -9999)
resultsYear[] <- lapply(resultsYear, function(x) type.convert(as.character(x)))
countiesYear <- resultsYear %>%
group_by(state=STATE, county=COUNTY) %>%
summarize_(dem=quote(dem_col),rep=quote(rep_col),other=quote(oth_col)) %>%
gather(party, votes, dem:other)
statesYear <- countiesYear %>%
group_by(state, party) %>%
summarize(votes=sum(votes))
totalYear <- statesYear %>%
group_by(party) %>%
summarize(votes=sum(votes))
write.csv(countiesYear, paste("./data/csv/counties", year, ".csv", sep = ""), row.names = FALSE)
write.csv(statesYear, paste("./data/csv/states", year, ".csv", sep = ""), row.names=FALSE)
write.csv(totalYear, paste("./data/csv/total", year, ".csv", sep = ""), row.names = FALSE)
}
getResults(2004, VOTE_DEM, VOTE_REP, VOTE_OTH)
getResults <- function(year, dem_col, rep_col, oth_col) {
resultsYear <- read.dbf(paste("./data/dbf/", year, ".dbf", sep=""))
resultsYear <- resultsYear$dbf
resultsYear <- resultsYear %>%
distinct(FIPS) %>%
na.omit() %>%
filter_(interp(~dem_col) != -9999)
resultsYear[] <- lapply(resultsYear, function(x) type.convert(as.character(x)))
countiesYear <- resultsYear %>%
group_by(state=STATE, county=COUNTY) %>%
summarize_(dem=quote(dem_col),rep=quote(rep_col),other=quote(oth_col)) %>%
gather_(party, votes, dem:other)
statesYear <- countiesYear %>%
group_by(state, party) %>%
summarize(votes=sum(votes))
totalYear <- statesYear %>%
group_by(party) %>%
summarize(votes=sum(votes))
write.csv(countiesYear, paste("./data/csv/counties", year, ".csv", sep = ""), row.names = FALSE)
write.csv(statesYear, paste("./data/csv/states", year, ".csv", sep = ""), row.names=FALSE)
write.csv(totalYear, paste("./data/csv/total", year, ".csv", sep = ""), row.names = FALSE)
}
getResults(2004, VOTE_DEM, VOTE_REP, VOTE_OTH)
getResults <- function(year, dem_col, rep_col, oth_col) {
resultsYear <- read.dbf(paste("./data/dbf/", year, ".dbf", sep=""))
resultsYear <- resultsYear$dbf
resultsYear <- resultsYear %>%
distinct(FIPS) %>%
na.omit() %>%
filter_(interp(~dem_col) != -9999)
resultsYear[] <- lapply(resultsYear, function(x) type.convert(as.character(x)))
countiesYear <- resultsYear %>%
group_by(state=STATE, county=COUNTY) %>%
summarize_(dem=quote(dem_col),rep=quote(rep_col),other=quote(oth_col)) %>%
gather(party, votes, dem:other)
statesYear <- countiesYear %>%
group_by(state, party) %>%
summarize(votes=sum(votes))
totalYear <- statesYear %>%
group_by(party) %>%
summarize(votes=sum(votes))
write.csv(countiesYear, paste("./data/csv/counties", year, ".csv", sep = ""), row.names = FALSE)
write.csv(statesYear, paste("./data/csv/states", year, ".csv", sep = ""), row.names=FALSE)
write.csv(totalYear, paste("./data/csv/total", year, ".csv", sep = ""), row.names = FALSE)
}
getResults(2004, VOTE_DEM, VOTE_REP, VOTE_OTH)
getResults(2004, VOTE_DEM, VOTE_REP, VOTE_OTH)
getResults <- function(year, dem_col, rep_col, oth_col) {
resultsYear <- read.dbf(paste("./data/dbf/", year, ".dbf", sep=""))
resultsYear <- resultsYear$dbf
resultsYear <- resultsYear %>%
distinct(FIPS) %>%
na.omit() %>%
filter_(interp(~dem_col) != -9999)
resultsYear[] <- lapply(resultsYear, function(x) type.convert(as.character(x)))
countiesYear <- resultsYear %>%
group_by(state=STATE, county=COUNTY) %>%
summarize_(dem=lazyeval::interp(dem_col),rep=lazyeval::interp(rep_col),other=lazyeval::interp(oth_col)) %>%
gather(party, votes, dem:other)
statesYear <- countiesYear %>%
group_by(state, party) %>%
summarize(votes=sum(votes))
totalYear <- statesYear %>%
group_by(party) %>%
summarize(votes=sum(votes))
write.csv(countiesYear, paste("./data/csv/counties", year, ".csv", sep = ""), row.names = FALSE)
write.csv(statesYear, paste("./data/csv/states", year, ".csv", sep = ""), row.names=FALSE)
write.csv(totalYear, paste("./data/csv/total", year, ".csv", sep = ""), row.names = FALSE)
}
getResults(2004, VOTE_DEM, VOTE_REP, VOTE_OTH)
getResults <- function(year, dem_col, rep_col, oth_col) {
resultsYear <- read.dbf(paste("./data/dbf/", year, ".dbf", sep=""))
resultsYear <- resultsYear$dbf
resultsYear <- resultsYear %>%
distinct(FIPS) %>%
na.omit() %>%
filter_(interp(~dem_col) != -9999)
resultsYear[] <- lapply(resultsYear, function(x) type.convert(as.character(x)))
countiesYear <- resultsYear %>%
group_by(state=STATE, county=COUNTY) %>%
summarize_(dem=interp(as.name(dem_col)),rep=interp(as.name(rep_col)),other=interp(as.name(oth_col))) %>%
gather(party, votes, dem:other)
statesYear <- countiesYear %>%
group_by(state, party) %>%
summarize(votes=sum(votes))
totalYear <- statesYear %>%
group_by(party) %>%
summarize(votes=sum(votes))
write.csv(countiesYear, paste("./data/csv/counties", year, ".csv", sep = ""), row.names = FALSE)
write.csv(statesYear, paste("./data/csv/states", year, ".csv", sep = ""), row.names=FALSE)
write.csv(totalYear, paste("./data/csv/total", year, ".csv", sep = ""), row.names = FALSE)
}
getResults(2004, VOTE_DEM, VOTE_REP, VOTE_OTH)
getResults <- function(year, dem_col, rep_col, oth_col) {
dc <- dem_col
rc <- rep_col
oc <- oc
resultsYear <- read.dbf(paste("./data/dbf/", year, ".dbf", sep=""))
resultsYear <- resultsYear$dbf
resultsYear <- resultsYear %>%
distinct(FIPS) %>%
na.omit() %>%
filter_(dc != -9999)
resultsYear[] <- lapply(resultsYear, function(x) type.convert(as.character(x)))
countiesYear <- resultsYear %>%
group_by(state=STATE, county=COUNTY) %>%
summarize_(dem=quote(dc),rep=quote(rc),other=quote(oc)) %>%
gather(party, votes, dem:other)
statesYear <- countiesYear %>%
group_by(state, party) %>%
summarize(votes=sum(votes))
totalYear <- statesYear %>%
group_by(party) %>%
summarize(votes=sum(votes))
write.csv(countiesYear, paste("./data/csv/counties", year, ".csv", sep = ""), row.names = FALSE)
write.csv(statesYear, paste("./data/csv/states", year, ".csv", sep = ""), row.names=FALSE)
write.csv(totalYear, paste("./data/csv/total", year, ".csv", sep = ""), row.names = FALSE)
}
getResults(2004, VOTE_DEM, VOTE_REP, VOTE_OTH)
getResults <- function(year, dem_col, rep_col, oth_col) {
resultsYear <- read.dbf(paste("./data/dbf/", year, ".dbf", sep=""))
resultsYear <- resultsYear$dbf
dc <- resultsYear$dem_col
rc <- resultsYear$rep_col
oc <- resultsYear$oth_col
resultsYear <- resultsYear %>%
distinct(FIPS) %>%
na.omit() %>%
filter_(dc != -9999)
resultsYear[] <- lapply(resultsYear, function(x) type.convert(as.character(x)))
countiesYear <- resultsYear %>%
group_by(state=STATE, county=COUNTY) %>%
summarize_(dem=quote(dc),rep=quote(rc),other=quote(oc)) %>%
gather(party, votes, dem:other)
statesYear <- countiesYear %>%
group_by(state, party) %>%
summarize(votes=sum(votes))
totalYear <- statesYear %>%
group_by(party) %>%
summarize(votes=sum(votes))
write.csv(countiesYear, paste("./data/csv/counties", year, ".csv", sep = ""), row.names = FALSE)
write.csv(statesYear, paste("./data/csv/states", year, ".csv", sep = ""), row.names=FALSE)
write.csv(totalYear, paste("./data/csv/total", year, ".csv", sep = ""), row.names = FALSE)
}
getResults(2004, VOTE_DEM, VOTE_REP, VOTE_OTH)
getResults <- function(year, dem_col, rep_col, oth_col) {
resultsYear <- read.dbf(paste("./data/dbf/", year, ".dbf", sep=""))
resultsYear <- resultsYear$dbf
dc <- resultsYear$dem_col
rc <- resultsYear$rep_col
oc <- resultsYear$oth_col
resultsYear <- resultsYear %>%
distinct(FIPS) %>%
na.omit() %>%
filter_(dc != -9999)
resultsYear[] <- lapply(resultsYear, function(x) type.convert(as.character(x)))
countiesYear <- resultsYear %>%
group_by(state=STATE, county=COUNTY) %>%
summarize_(dem=dc,rep=rc,other=oc) %>%
gather(party, votes, dem:other)
statesYear <- countiesYear %>%
group_by(state, party) %>%
summarize(votes=sum(votes))
totalYear <- statesYear %>%
group_by(party) %>%
summarize(votes=sum(votes))
write.csv(countiesYear, paste("./data/csv/counties", year, ".csv", sep = ""), row.names = FALSE)
write.csv(statesYear, paste("./data/csv/states", year, ".csv", sep = ""), row.names=FALSE)
write.csv(totalYear, paste("./data/csv/total", year, ".csv", sep = ""), row.names = FALSE)
}
getResults(2004, VOTE_DEM, VOTE_REP, VOTE_OTH)
getResults(2008, VOTE_DEM, VOTE_REP, VOTE_OTH)
getResults(2012, OBAMA, ROMNEY, OTHERS)
getResults <- function(year, dem_col, rep_col, oth_col) {
resultsYear <- read.dbf(paste("./data/dbf/", year, ".dbf", sep=""))
resultsYear <- resultsYear$dbf
resultsYear <- resultsYear %>%
distinct(FIPS) %>%
na.omit() %>%
filter_(quote(dc) != -9999)
resultsYear[] <- lapply(resultsYear, function(x) type.convert(as.character(x)))
countiesYear <- resultsYear %>%
group_by(state=STATE, county=COUNTY) %>%
summarize_(dem=dc,rep=rc,other=oc) %>%
gather(party, votes, dem:other)
statesYear <- countiesYear %>%
group_by(state, party) %>%
summarize(votes=sum(votes))
totalYear <- statesYear %>%
group_by(party) %>%
summarize(votes=sum(votes))
write.csv(countiesYear, paste("./data/csv/counties", year, ".csv", sep = ""), row.names = FALSE)
write.csv(statesYear, paste("./data/csv/states", year, ".csv", sep = ""), row.names=FALSE)
write.csv(totalYear, paste("./data/csv/total", year, ".csv", sep = ""), row.names = FALSE)
}
getResults(2004, VOTE_DEM, VOTE_REP, VOTE_OTH)
getResults(2008, VOTE_DEM, VOTE_REP, VOTE_OTH)
getResults(2012, OBAMA, ROMNEY, OTHERS)
getResults <- function(year, dem_col, rep_col, oth_col) {
resultsYear <- read.dbf(paste("./data/dbf/", year, ".dbf", sep=""))
resultsYear <- resultsYear$dbf
resultsYear <- resultsYear %>%
distinct(FIPS) %>%
na.omit() %>%
filter_(~dc != -9999)
resultsYear[] <- lapply(resultsYear, function(x) type.convert(as.character(x)))
countiesYear <- resultsYear %>%
group_by(state=STATE, county=COUNTY) %>%
summarize_(dem=dc,rep=rc,other=oc) %>%
gather(party, votes, dem:other)
statesYear <- countiesYear %>%
group_by(state, party) %>%
summarize(votes=sum(votes))
totalYear <- statesYear %>%
group_by(party) %>%
summarize(votes=sum(votes))
write.csv(countiesYear, paste("./data/csv/counties", year, ".csv", sep = ""), row.names = FALSE)
write.csv(statesYear, paste("./data/csv/states", year, ".csv", sep = ""), row.names=FALSE)
write.csv(totalYear, paste("./data/csv/total", year, ".csv", sep = ""), row.names = FALSE)
}
getResults(2004, VOTE_DEM, VOTE_REP, VOTE_OTH)
getResults(2008, VOTE_DEM, VOTE_REP, VOTE_OTH)
getResults(2012, OBAMA, ROMNEY, OTHERS)
